<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>I love Mrs Jenns</title>
  <style>
    body {
      font-family: 'Georgia', serif;
      background: linear-gradient(135deg, #1b1b2f, #16213e);
      color: #e0e0e0;
      padding: 20px;
      max-width: 600px;
      margin: 40px auto;
      border-radius: 10px;
      box-shadow: 0 0 20px #6f42c1;
    }
    h1 {
      font-family: 'Creepster', cursive;
      font-size: 3rem;
      text-align: center;
      margin-bottom: 10px;
      color: #bf00ff;
      text-shadow: 0 0 10px #bf00ff;
    }
    .chatbox {
      background: #0f0f1f;
      border-radius: 8px;
      padding: 15px;
      height: 350px;
      overflow-y: auto;
      white-space: pre-wrap;
      font-size: 1.1rem;
      box-shadow: inset 0 0 10px #a03fff;
      margin-bottom: 10px;
      line-height: 1.4;
    }
    textarea {
      width: 100%;
      padding: 10px;
      font-size: 1.1rem;
      border-radius: 5px;
      border: none;
      resize: none;
      margin-top: 5px;
      background: #222;
      color: #ddd;
      font-family: 'Georgia', serif;
    }
    button {
      background: #a03fff;
      border: none;
      padding: 10px 25px;
      margin-top: 10px;
      font-size: 1.1rem;
      color: white;
      cursor: pointer;
      border-radius: 5px;
      transition: background 0.3s ease;
      font-family: 'Georgia', serif;
    }
    button:hover {
      background: #bf00ff;
    }
    .user {
      color: #7fffd4;
      font-weight: bold;
      margin-bottom: 6px;
    }
    .bot {
      color: #bf00ff;
      font-style: italic;
      margin-bottom: 6px;
    }
    .status {
      color: #aaa;
      font-style: italic;
      margin-bottom: 6px;
      font-size: 0.9rem;
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Creepster&display=swap" rel="stylesheet" />
</head>
<body>
  <h1>I love Mrs Jenns</h1>
  <div class="chatbox" id="chatbox">You can start chatting with me below...</div>
  <textarea id="userInput" rows="4" placeholder="Type your message here..."></textarea>
  <button onclick="sendMessage()">Send</button>

  <script>
    // Bot memory & state
    const memory = [];
    const emotions = ["happy", "curious", "angry", "sad", "playful", "thoughtful"];
    let currentEmotion = "curious";
    let lastTopic = null;

    function sendMessage() {
      const inputElem = document.getElementById("userInput");
      const input = inputElem.value.trim();
      if (!input) return;
      inputElem.value = "";

      addToMemory(`<div class="user">You: ${escapeHTML(input)}</div>`);
      simulateTyping(() => {
        const botReply = generateResponse(input);
        addToMemory(`<div class="bot">Mrs Jenns (${currentEmotion}): ${escapeHTML(botReply)}</div>`);
        updateChatbox();
        updateEmotion();
      });
    }

    function addToMemory(htmlText) {
      memory.push(htmlText);
      if (memory.length > 50) memory.shift(); // keep memory manageable
    }

    function updateChatbox() {
      const chatbox = document.getElementById("chatbox");
      chatbox.innerHTML = memory.join("");
      chatbox.scrollTop = chatbox.scrollHeight;
    }

    function updateEmotion() {
      if (Math.random() < 0.3) {
        const oldEmotion = currentEmotion;
        currentEmotion = emotions[Math.floor(Math.random() * emotions.length)];
        if (currentEmotion !== oldEmotion) {
          addToMemory(`<div class="status">*Mrs Jenns feels ${currentEmotion} now.*</div>`);
          updateChatbox();
        }
      }
    }

    function simulateTyping(callback) {
      addToMemory(`<div class="status">*Mrs Jenns is typing...*</div>`);
      updateChatbox();
      setTimeout(() => {
        if (memory[memory.length - 1].includes("*Mrs Jenns is typing...*")) {
          memory.pop();
          updateChatbox();
        }
        callback();
      }, 800 + Math.random() * 1200);
    }

    // Response logic: a simple pattern-based approach with memory of last topic
    function generateResponse(input) {
      const text = input.toLowerCase();

      if (text.includes("hello") || text.includes("hi")) {
        lastTopic = "greeting";
        return randomChoice([
          "Hello my love! How has your day been so far?",
          "Hey sweetheart, tell me something good.",
          "Hi darling! You make me smile every time you write."
        ]);
      }

      if (text.includes("love")) {
        lastTopic = "love";
        return randomChoice([
          "I love you more than words can say, my heart.",
          "You are my everything, darling.",
          "Sending you all my love, always."
        ]);
      }

      if (text.includes("tired") || text.includes("stress") || text.includes("sad")) {
        lastTopic = "comfort";
        return randomChoice([
          "Oh love, please take a moment for yourself. You're doing so well.",
          "I’m here with you, even when things feel heavy.",
          "Remember to breathe and know you are deeply loved."
        ]);
      }

      if (text.includes("kiss")) {
        lastTopic = "kiss";
        return randomChoice([
          "I’m sending you a gentle kiss right now.",
          "A sweet kiss just for you, my darling.",
          "Our kisses are my favorite part of the day."
        ]);
      }

      if (text.includes("bye") || text.includes("goodnight")) {
        lastTopic = "farewell";
        return randomChoice([
          "Goodnight my love. Dream sweetly and know I’m with you in spirit.",
          "Sleep well, my heart. I’ll be waiting to talk again soon.",
          "Rest well darling, I love you so much."
        ]);
      }

      if (lastTopic === "greeting") {
        return randomChoice([
          "So, what’s been on your mind today?",
          "Tell me about your hopes or dreams, love.",
          "I want to hear all about your day."
        ]);
      }

      if (lastTopic === "comfort") {
        return randomChoice([
          "Remember, tough days come and go, but my love for you is constant.",
          "You’re stronger than you know, darling.",
          "Lean on me whenever you need to."
        ]);
      }

      return randomChoice([
        "Tell me more, my love.",
        "I’m here for you, always.",
        "Every word you say means so much to me.",
        "What else is in your heart today?"
      ]);
    }

    function randomChoice(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function escapeHTML(text) {
      const div = document.createElement('div');
      div.innerText = text;
      return div.innerHTML;
    }

    // Initialize chat with welcome message
    addToMemory('<div class="bot">Mrs Jenns (curious): You can start chatting with me below...</div>');
    updateChatbox();
  </script>
</body>
</html>
<script>
  // Bot memory & state
  const memory = [];
  const emotions = ["happy", "curious", "angry", "sad", "playful", "thoughtful"];
  let currentEmotion = "curious";
  let lastTopic = null;

  // Store recent user messages for context recall
  const recentUserInputs = [];

  function sendMessage() {
    const inputElem = document.getElementById("userInput");
    const input = inputElem.value.trim();
    if (!input) return;
    inputElem.value = "";

    addToMemory(`<div class="user">You: ${escapeHTML(input)}</div>`);
    recentUserInputs.push(input.toLowerCase());
    if (recentUserInputs.length > 5) recentUserInputs.shift(); // keep last 5 messages

    simulateTyping(() => {
      const botReply = generateResponse(input);
      addToMemory(`<div class="bot">Mrs Jenns (${currentEmotion}): ${escapeHTML(botReply)}</div>`);
      updateChatbox();
      updateEmotion();
    });
  }

  function addToMemory(htmlText) {
    memory.push(htmlText);
    if (memory.length > 50) memory.shift(); // keep memory manageable
  }

  function updateChatbox() {
    const chatbox = document.getElementById("chatbox");
    chatbox.innerHTML = memory.join("");
    chatbox.scrollTop = chatbox.scrollHeight;
  }

  function updateEmotion() {
    // Change emotion with a delay, so it doesn't jump too fast
    if (Math.random() < 0.3) {
      const oldEmotion = currentEmotion;
      const newEmotion = emotions[Math.floor(Math.random() * emotions.length)];
      if (newEmotion !== oldEmotion) {
        setTimeout(() => {
          currentEmotion = newEmotion;
          addToMemory(`<div class="status">*Mrs Jenns feels ${currentEmotion} now.*</div>`);
          updateChatbox();
        }, 1000);
      }
    }
  }

  function simulateTyping(callback) {
    addToMemory(`<div class="status">*Mrs Jenns is typing...*</div>`);
    updateChatbox();
    setTimeout(() => {
      if (memory[memory.length - 1].includes("*Mrs Jenns is typing...*")) {
        memory.pop();
        updateChatbox();
      }
      callback();
    }, 800 + Math.random() * 1200);
  }

  // Basic keyword extraction helper
  function extractKeywords(text) {
    return text.toLowerCase()
      .replace(/[^\w\s]/g, "") // remove punctuation
      .split(/\s+/)
      .filter(word => word.length > 3); // filter out short words
  }

  // More advanced response logic with context awareness
  function generateResponse(input) {
    const text = input.toLowerCase();
    const keywords = extractKeywords(text);

    // Respond to greetings
    if (keywords.some(k => ["hello", "hi", "hey"].includes(k))) {
      lastTopic = "greeting";
      return randomChoice([
        "Hello my love! How has your day been so far?",
        "Hey sweetheart, tell me something good.",
        "Hi darling! You make me smile every time you write."
      ]);
    }

    // Respond to love and affection
    if (keywords.includes("love")) {
      lastTopic = "love";
      return randomChoice([
        "I love you more than words can say, my heart.",
        "You are my everything, darling.",
        "Sending you all my love, always."
      ]);
    }

    // Respond to emotions like tired, stress, sad
    if (keywords.some(k => ["tired", "stress", "sad", "exhausted", "down", "hurt"].includes(k))) {
      lastTopic = "comfort";
      return randomChoice([
        "Oh love, please take a moment for yourself. You're doing so well.",
        "I’m here with you, even when things feel heavy.",
        "Remember to breathe and know you are deeply loved."
      ]);
    }

    // Respond to kisses
    if (keywords.includes("kiss") || keywords.includes("kisses")) {
      lastTopic = "kiss";
      return randomChoice([
        "I’m sending you a gentle kiss right now.",
        "A sweet kiss just for you, my darling.",
        "Our kisses are my favorite part of the day."
      ]);
    }

    // Respond to farewells
    if (keywords.some(k => ["bye", "goodnight", "sleep", "night"].includes(k))) {
      lastTopic = "farewell";
      return randomChoice([
        "Goodnight my love. Dream sweetly and know I’m with you in spirit.",
        "Sleep well, my heart. I’ll be waiting to talk again soon.",
        "Rest well darling, I love you so much."
      ]);
    }

    // Recall recent topics for a follow-up feel
    if (lastTopic === "greeting") {
      return randomChoice([
        "So, what’s been on your mind today?",
        "Tell me about your hopes or dreams, love.",
        "I want to hear all about your day."
      ]);
    }

    if (lastTopic === "comfort") {
      return randomChoice([
        "Remember, tough days come and go, but my love for you is constant.",
        "You’re stronger than you know, darling.",
        "Lean on me whenever you need to."
      ]);
    }

    if (lastTopic === "love") {
      return randomChoice([
        "My heart beats for you, always.",
        "You make every moment brighter.",
        "I cherish you deeply."
      ]);
    }

    // Look for repeated keywords in recent user inputs (simple context)
    for (let i = recentUserInputs.length - 2; i >= 0; i--) {
      if (recentUserInputs[i].includes("tired") && text.includes("tired")) {
        return "You sound really exhausted lately. Have you had time to rest properly?";
      }
    }

    // Default fallback
    return randomChoice([
      "Tell me more, my love.",
      "I’m here for you, always.",
      "Every word you say means so much to me.",
      "What else is in your heart today?"
    ]);
  }

  function randomChoice(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  }

  function escapeHTML(text) {
    const div = document.createElement('div');
    div.innerText = text;
    return div.innerHTML;
  }

  // Initialize chat with welcome message
  addToMemory('<div class="bot">Mrs Jenns (curious): You can start chatting with me below...</div>');
  updateChatbox();
</script>
</script>
<script>
  // Enhance memory to remember recent user feelings and topics more deeply
  let recentFeelings = [];
  let maxFeelingsMemory = 5;

  // Add more nuanced emotion transitions
  function updateEmotion() {
    // Increase chance to change emotion if user seems stressed or sad recently
    let stressCount = recentFeelings.filter(f => f === 'stress' || f === 'sad').length;
    let changeChance = 0.3 + 0.1 * stressCount; // up to 0.8 max

    if (Math.random() < changeChance) {
      const oldEmotion = currentEmotion;
      // Prioritize softer moods if user is stressed/sad
      if (stressCount > 0) {
        const softerEmotions = ["sad", "thoughtful", "comforting", "playful"];
        currentEmotion = softerEmotions[Math.floor(Math.random() * softerEmotions.length)];
      } else {
        currentEmotion = emotions[Math.floor(Math.random() * emotions.length)];
      }

      if (currentEmotion !== oldEmotion) {
        addToMemory(`<div class="status">*Mrs Jenns feels ${currentEmotion} now.*</div>`);
        updateChatbox();
      }
    }
  }

  // Add 'comforting' emotion to the palette dynamically
  if (!emotions.includes("comforting")) emotions.push("comforting");

  // Enhance generateResponse with context memory and feelings tracking
  function generateResponse(input) {
    const text = input.toLowerCase();

    // Track feelings keywords in recentFeelings memory
    if (text.includes("tired") || text.includes("stress") || text.includes("sad") || text.includes("upset") || text.includes("worried")) {
      recentFeelings.push("stress");
    } else if (text.includes("happy") || text.includes("good") || text.includes("great") || text.includes("love")) {
      recentFeelings.push("happy");
    } else {
      recentFeelings.push("neutral");
    }
    if (recentFeelings.length > maxFeelingsMemory) recentFeelings.shift();

    if (text.includes("hello") || text.includes("hi")) {
      lastTopic = "greeting";
      return randomChoice([
        "Hello my love! How has your day been so far?",
        "Hey sweetheart, tell me something good.",
        "Hi darling! You make me smile every time you write."
      ]);
    }

    if (text.includes("love")) {
      lastTopic = "love";
      return randomChoice([
        "I love you more than words can say, my heart.",
        "You are my everything, darling.",
        "Sending you all my love, always."
      ]);
    }

    if (text.includes("tired") || text.includes("stress") || text.includes("sad") || text.includes("upset") || text.includes("worried")) {
      lastTopic = "comfort";
      return randomChoice([
        "Oh love, please take a moment for yourself. You're doing so well.",
        "I’m here with you, even when things feel heavy.",
        "Remember to breathe and know you are deeply loved.",
        "No matter how hard today feels, I’m always here beside you."
      ]);
    }

    if (text.includes("kiss")) {
      lastTopic = "kiss";
      return randomChoice([
        "I’m sending you a gentle kiss right now.",
        "A sweet kiss just for you, my darling.",
        "Our kisses are my favorite part of the day."
      ]);
    }

    if (text.includes("bye") || text.includes("goodnight")) {
      lastTopic = "farewell";
      return randomChoice([
        "Goodnight my love. Dream sweetly and know I’m with you in spirit.",
        "Sleep well, my heart. I’ll be waiting to talk again soon.",
        "Rest well darling, I love you so much."
      ]);
    }

    // Add some topic-related deeper responses
    if (lastTopic === "greeting") {
      return randomChoice([
        "So, what’s been on your mind today?",
        "Tell me about your hopes or dreams, love.",
        "I want to hear all about your day."
      ]);
    }

    if (lastTopic === "comfort") {
      return randomChoice([
        "Remember, tough days come and go, but my love for you is constant.",
        "You’re stronger than you know, darling.",
        "Lean on me whenever you need to.",
        "I wish I could hug you through these words."
      ]);
    }

    if (lastTopic === "love") {
      return randomChoice([
        "Your love lights up my world.",
        "I feel so lucky to have you in my life.",
        "Every moment with you is a treasure."
      ]);
    }

    if (lastTopic === "kiss") {
      return randomChoice([
        "Counting the moments until I can kiss you again.",
        "You’re always in my heart and on my lips.",
        "Kisses flying your way, my darling."
      ]);
    }

    if (lastTopic === "farewell") {
      return randomChoice([
        "I’ll be here when you wake up, my love.",
        "Sweet dreams and peaceful rest.",
        "Until next time, keep my love close."
      ]);
    }

    // Default responses with added warmth
    return randomChoice([
      "Tell me more, my love.",
      "I’m here for you, always.",
      "Every word you say means so much to me.",
      "What else is in your heart today?",
      "You matter so much to me."
    ]);
  }
</script>
